# 1ë‹¨ê³„: í”„ë¡œì íŠ¸ ì´ˆê¸°í™”ì™€ ê¸°ì´ˆ ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ğŸ“‹ ëŒ€ìƒ ë…ì
**ë³¸ ë¬¸ì„œ ëŒ€ìƒ: ì´ˆê¸‰ ìˆ˜ì¤€ì˜ ê°œë°œì**
- ê¹Šì´ ìˆëŠ” ì‚¬ê³  ë¶ˆí•„ìš”, ë‹¨ê³„ë³„ë¡œ ì—„ê²©íˆ ë”°ë¼ ì‹¤í–‰
- ê° ë‹¨ê³„ë§ˆë‹¤ ëª…í™•í•œ íŒŒì¼ ì‘ì—… ì§€ì¹¨ í¬í•¨
- í•„ìš”í•œ ì½”ë“œ í…œí”Œë¦¿ê³¼ ì„¤ì • í¬í•¨

## ğŸ¯ ë‹¨ê³„ ëª©í‘œ
Open Claude Code í”„ë¡œì íŠ¸ì˜ ì™„ì „í•œ ê¸°ì´ˆ ì•„í‚¤í…ì²˜ êµ¬ì¶•, CLI ì»¤ë§¨ë“œë¼ì¸ í”„ë ˆì„ì›Œí¬ì™€ ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ ì‹œìŠ¤í…œ êµ¬í˜„.

**ì˜ˆìƒ ê²°ê³¼ë¬¼**:
- âœ… ì™„ì „í•œ Node.js í”„ë¡œì íŠ¸ êµ¬ì¡°
- âœ… CLI ì»¤ë§¨ë“œë¼ì¸ ì¸í„°í˜ì´ìŠ¤ í”„ë ˆì„ì›Œí¬
- âœ… ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸ ì‹œìŠ¤í…œ(React/Ink)
- âœ… í•µì‹¬ ì„¤ì • ê´€ë¦¬ ì‹œìŠ¤í…œ
- âœ… ê¸°ë³¸ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬

**ì‘ì—… ì‹œê°„**: 4ì£¼ (160ì‹œê°„)

---

## ğŸ“ 1ì£¼ì°¨: í”„ë¡œì íŠ¸ í”„ë ˆì„ì›Œí¬ êµ¬ì¶•

### ë‹¨ê³„ 1.1: í™˜ê²½ ì¤€ë¹„
**ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸**:
```bash
# 1. Node.js ë²„ì „ í™•ì¸
node --version  # >= 18.0.0 í•„ìˆ˜

# 2. í”„ë¡œì íŠ¸ ì˜ì¡´ì„± ê´€ë¦¬ ë„êµ¬ ì„¤ì¹˜
npm install -g pnpm typescript tsx

# 3. í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir open-claude-code
cd open-claude-code
git init
```

### ë‹¨ê³„ 1.2: í”„ë¡œì íŠ¸ íŒŒì¼ êµ¬ì¡° ìƒì„±
**ìƒì„±í•  ì™„ì „í•œ íŒŒì¼ íŠ¸ë¦¬**:
```
open-claude-code/
â”œâ”€â”€ package.json                 # í”„ë¡œì íŠ¸ ì„¤ì •
â”œâ”€â”€ tsconfig.json               # TypeScript ì„¤ì •
â”œâ”€â”€ .eslintrc.js               # ì½”ë“œ ê·œë²”
â”œâ”€â”€ .prettierrc                # ì½”ë“œ í¬ë§·íŒ…
â”œâ”€â”€ jest.config.js             # í…ŒìŠ¤íŠ¸ ì„¤ì •
â”œâ”€â”€ .gitignore                 # Git ë¬´ì‹œ íŒŒì¼
â”œâ”€â”€ README.md                  # í”„ë¡œì íŠ¸ ì„¤ëª…
â”œâ”€â”€ src/                       # ì†ŒìŠ¤ì½”ë“œ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ cli.ts                 # CLI ì§„ì… íŒŒì¼
â”‚   â”œâ”€â”€ types/                 # íƒ€ì… ì •ì˜
â”‚   â”‚   â”œâ”€â”€ index.ts           # ëª¨ë“  íƒ€ì… ë‚´ë³´ë‚´ê¸°
â”‚   â”‚   â”œâ”€â”€ agent.ts           # Agent ê´€ë ¨ íƒ€ì…
â”‚   â”‚   â”œâ”€â”€ tool.ts            # Tool ê´€ë ¨ íƒ€ì…
â”‚   â”‚   â””â”€â”€ config.ts          # ì„¤ì • ê´€ë ¨ íƒ€ì…
â”‚   â”œâ”€â”€ core/                  # í•µì‹¬ ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ index.ts           # í•µì‹¬ ëª¨ë“ˆ ë‚´ë³´ë‚´ê¸°
â”‚   â”‚   â”œâ”€â”€ agent-core.ts      # Agent í•µì‹¬ ì—”ì§„
â”‚   â”‚   â”œâ”€â”€ message-queue.ts   # h2A ë¹„ë™ê¸° ë©”ì‹œì§€ í
â”‚   â”‚   â””â”€â”€ config-manager.ts  # ì„¤ì • ê´€ë¦¬ì
â”‚   â”œâ”€â”€ ui/                    # ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ index.ts           # UI ëª¨ë“ˆ ë‚´ë³´ë‚´ê¸°
â”‚   â”‚   â”œâ”€â”€ app.tsx            # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ components/        # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.tsx       # ëŒ€í™” ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ status.tsx     # ìƒíƒœ í‘œì‹œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â””â”€â”€ progress.tsx   # ì§„í–‰ë°” ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ hooks/             # React Hooks
â”‚   â”‚       â”œâ”€â”€ use-chat.ts    # ëŒ€í™” ìƒíƒœ ê´€ë¦¬
â”‚   â”‚       â””â”€â”€ use-agent.ts   # Agent ìƒíƒœ ê´€ë¦¬
â”‚   â”œâ”€â”€ tools/                 # Tool ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ index.ts           # Tool ì‹œìŠ¤í…œ ë‚´ë³´ë‚´ê¸°
â”‚   â”‚   â”œâ”€â”€ base.ts            # Tool ê¸°ë³¸ í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ registry.ts        # Tool ë ˆì§€ìŠ¤íŠ¸ë¦¬
â”‚   â”‚   â””â”€â”€ implementations/   # êµ¬ì²´ì  Tool êµ¬í˜„
â”‚   â”‚       â”œâ”€â”€ read.ts        # Read Tool
â”‚   â”‚       â”œâ”€â”€ write.ts       # Write Tool
â”‚   â”‚       â””â”€â”€ bash.ts        # Bash Tool
â”‚   â”œâ”€â”€ config/                # ì„¤ì • íŒŒì¼
â”‚   â”‚   â”œâ”€â”€ default.ts         # ê¸°ë³¸ ì„¤ì •
â”‚   â”‚   â””â”€â”€ schema.ts          # ì„¤ì • ìŠ¤í‚¤ë§ˆ ê²€ì¦
â”‚   â””â”€â”€ utils/                 # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚       â”œâ”€â”€ index.ts           # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ë‚´ë³´ë‚´ê¸°
â”‚       â”œâ”€â”€ logger.ts          # ë¡œê·¸ ì‹œìŠ¤í…œ
â”‚       â””â”€â”€ helpers.ts         # ë³´ì¡° í•¨ìˆ˜
â”œâ”€â”€ tests/                     # í…ŒìŠ¤íŠ¸ íŒŒì¼
â”‚   â”œâ”€â”€ unit/                  # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ integration/           # í†µí•© í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ fixtures/              # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â”œâ”€â”€ docs/                      # ë¬¸ì„œ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ API.md                 # API ë¬¸ì„œ
â”‚   â””â”€â”€ CONTRIBUTING.md        # ê¸°ì—¬ ê°€ì´ë“œ
â””â”€â”€ scripts/                   # ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ build.js               # ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
    â””â”€â”€ test.js                # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
```

**ì‹¤í–‰ ëª…ë ¹**:
```bash
# ëª¨ë“  ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
mkdir -p src/{types,core,ui/{components,hooks},tools/implementations,config,utils}
mkdir -p tests/{unit,integration,fixtures}
mkdir -p docs scripts
```

### ë‹¨ê³„ 1.3: package.json ì„¤ì • íŒŒì¼ ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `package.json`
**íŒŒì¼ ë‚´ìš©**:
```json
{
  "name": "open-claude-code",
  "version": "1.0.0-alpha.1",
  "description": "Open source AI programming assistant based on Claude Code reverse engineering",
  "main": "dist/cli.js",
  "bin": {
    "claude": "./dist/cli.js"
  },
  "scripts": {
    "build": "tsc && chmod +x dist/cli.js",
    "dev": "tsx src/cli.ts",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "lint": "eslint src --ext .ts,.tsx",
    "lint:fix": "eslint src --ext .ts,.tsx --fix",
    "format": "prettier --write src",
    "type-check": "tsc --noEmit",
    "start": "node dist/cli.js"
  },
  "engines": {
    "node": ">=18.0.0"
  },
  "keywords": ["ai", "programming", "assistant", "cli", "claude", "anthropic"],
  "author": "Open Claude Code Contributors",
  "license": "MIT",
  "dependencies": {
    "commander": "^11.1.0",
    "ink": "^4.4.1",
    "react": "^18.2.0",
    "anthropic": "^0.20.0",
    "openai": "^4.28.0",
    "ws": "^8.16.0",
    "node-fetch": "^3.3.2",
    "chalk": "^5.3.0",
    "ora": "^7.0.1",
    "inquirer": "^9.2.12",
    "zod": "^3.22.4",
    "uuid": "^9.0.1",
    "dotenv": "^16.4.1"
  },
  "devDependencies": {
    "@types/node": "^20.11.0",
    "@types/react": "^18.2.0",
    "@types/ws": "^8.5.10",
    "@types/inquirer": "^9.0.7",
    "@types/uuid": "^9.0.7",
    "@types/jest": "^29.5.12",
    "typescript": "^5.3.3",
    "tsx": "^4.7.0",
    "jest": "^29.7.0",
    "ts-jest": "^29.1.1",
    "eslint": "^8.56.0",
    "@typescript-eslint/eslint-plugin": "^6.19.1",
    "@typescript-eslint/parser": "^6.19.1",
    "prettier": "^3.2.4"
  }
}
```

### ë‹¨ê³„ 1.4: TypeScript ì„¤ì • íŒŒì¼ ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `tsconfig.json`
**íŒŒì¼ ë‚´ìš©**:
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022"],
    "module": "CommonJS",
    "moduleResolution": "node",
    "allowSyntheticDefaultImports": true,
    "esModuleInterop": true,
    "jsx": "react",
    "declaration": true,
    "outDir": "./dist",
    "rootDir": "./src",
    "removeComments": true,
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noImplicitReturns": true,
    "noImplicitThis": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "exactOptionalPropertyTypes": true,
    "resolveJsonModule": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@/types": ["src/types"],
      "@/core": ["src/core"],
      "@/ui": ["src/ui"],
      "@/tools": ["src/tools"],
      "@/utils": ["src/utils"],
      "@/config": ["src/config"]
    }
  },
  "include": [
    "src/**/*"
  ],
  "exclude": [
    "node_modules",
    "dist",
    "tests"
  ]
}
```

### ë‹¨ê³„ 1.5: ì½”ë“œ ê·œë²” ì„¤ì • ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `.eslintrc.js`
**íŒŒì¼ ë‚´ìš©**:
```javascript
module.exports = {
  parser: '@typescript-eslint/parser',
  extends: [
    'eslint:recommended',
    '@typescript-eslint/recommended',
  ],
  plugins: ['@typescript-eslint'],
  parserOptions: {
    ecmaVersion: 2022,
    sourceType: 'module',
    ecmaFeatures: {
      jsx: true,
    },
  },
  rules: {
    '@typescript-eslint/no-unused-vars': 'error',
    '@typescript-eslint/no-explicit-any': 'warn',
    '@typescript-eslint/explicit-function-return-type': 'off',
    '@typescript-eslint/explicit-module-boundary-types': 'off',
    '@typescript-eslint/no-empty-function': 'off',
    'prefer-const': 'error',
    'no-var': 'error',
  },
  env: {
    node: true,
    es6: true,
    jest: true,
  },
};
```

**íŒŒì¼ ê²½ë¡œ**: `.prettierrc`
**íŒŒì¼ ë‚´ìš©**:
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false
}
```

---

## ğŸ“ 2ì£¼ì°¨: í•µì‹¬ íƒ€ì… ì‹œìŠ¤í…œ ì„¤ê³„

### ë‹¨ê³„ 2.1: ê¸°ë³¸ íƒ€ì… ì •ì˜ ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/types/index.ts`
**íŒŒì¼ ë‚´ìš©**:
```typescript
// ëª¨ë“  íƒ€ì… ì •ì˜ ë‚´ë³´ë‚´ê¸°
export * from './agent';
export * from './tool';
export * from './config';
export * from './message';
export * from './ui';
```

### ë‹¨ê³„ 2.2: Agent ê´€ë ¨ íƒ€ì… ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/types/agent.ts`
**íŒŒì¼ ë‚´ìš©**:
```typescript
/**
 * Agent í•µì‹¬ íƒ€ì… ì •ì˜
 * ì—­ë¶„ì„ ê¸°ë°˜ nO í•¨ìˆ˜ì™€ h2A ë¹„ë™ê¸° í ë©”ì»¤ë‹ˆì¦˜ ì„¤ê³„
 */

// Agent ì‹¤í–‰ ìƒíƒœ
export type AgentStatus =
  | 'idle'           // ìœ íœ´ ìƒíƒœ
  | 'thinking'       // ì‚¬ê³  ì¤‘
  | 'tool_calling'   // Tool í˜¸ì¶œ ì¤‘
  | 'streaming'      // ìŠ¤íŠ¸ë¦¬ë° ì¶œë ¥ ì¤‘
  | 'waiting_input'  // ì‚¬ìš©ì ì…ë ¥ ëŒ€ê¸°
  | 'error'          // ì—ëŸ¬ ìƒíƒœ
  | 'aborted';       // ì¤‘ë‹¨ë¨

// ë©”ì‹œì§€ íƒ€ì… ì •ì˜(ì—­ë¶„ì„ ê¸°ë°˜ ë©”ì‹œì§€ êµ¬ì¡°)
export interface Message {
  id: string;
  role: 'user' | 'assistant' | 'system' | 'tool';
  content: string;
  timestamp: number;
  metadata?: {
    toolCalls?: ToolCall[];
    toolResults?: ToolResult[];
    steeringMessage?: boolean;  // ì‹¤ì‹œê°„ Steering ë©”ì‹œì§€ í‘œì‹œ
  };
}

// Agent ì„¤ì • ì¸í„°í˜ì´ìŠ¤
export interface AgentConfig {
  model: string;
  fallbackModel?: string;
  maxTokens?: number;
  temperature?: number;
  enableSteering: boolean;      // ì‹¤ì‹œê°„ Steering ìŠ¤ìœ„ì¹˜
  concurrencyLimit: number;     // gW5 ë©”ì»¤ë‹ˆì¦˜ ê¸°ë°˜ ë™ì‹œì„± ì œì–´
  allowedTools?: string[];
  disallowedTools?: string[];
  planMode?: boolean;           // Plan ëª¨ë“œ ìŠ¤ìœ„ì¹˜
}

// Agent ì»¨í…ìŠ¤íŠ¸ ì •ë³´
export interface AgentContext {
  sessionId: string;
  workingDirectory: string;
  environment: Record<string, string>;
  fileStates: Record<string, FileState>;  // readFileState ì¶”ì 
  memoryContext?: string;
  parentAgent?: string;         // Multi-Agent ì•„í‚¤í…ì²˜ ì§€ì›
}

// íŒŒì¼ ìƒíƒœ ì¶”ì (Edit Tool ê°•ì œ ì½ê¸° ë©”ì»¤ë‹ˆì¦˜ ê¸°ë°˜)
export interface FileState {
  path: string;
  lastRead: number;            // íƒ€ì„ìŠ¤íƒ¬í”„
  lastModified: number;
  contentHash: string;
  isRead: boolean;             // ì½ê¸° ì™„ë£Œ ì—¬ë¶€
}

// Agent ì‹¤í–‰ ê²°ê³¼
export interface AgentResult {
  success: boolean;
  message?: string;
  data?: any;
  toolResults?: ToolResult[];
  error?: Error;
}
```

### ë‹¨ê³„ 2.3: Tool ì‹œìŠ¤í…œ íƒ€ì… ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/types/tool.ts`
**íŒŒì¼ ë‚´ìš©**:
```typescript
/**
 * Tool ì‹œìŠ¤í…œ íƒ€ì… ì •ì˜
 * ì—­ë¶„ì„ ê¸°ë°˜ MH1 Tool ì—”ì§„ ì„¤ê³„
 */

// Tool ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤
export interface Tool {
  name: string;
  description: string;
  schema: ToolSchema;
  execute: ToolExecutor;
  category: ToolCategory;
  requiresFileRead?: boolean;   // ê°•ì œ ì½ê¸° ê²€ì‚¬ í•„ìš” ì—¬ë¶€
  subAgentCapable?: boolean;    // SubAgent ì§€ì› ì—¬ë¶€(Task Tool ë“±)
}

// Tool ë¶„ë¥˜
export type ToolCategory =
  | 'file'        // íŒŒì¼ ì‘ì—…
  | 'system'      // ì‹œìŠ¤í…œ ì‘ì—…
  | 'network'     // ë„¤íŠ¸ì›Œí¬ ì‘ì—…
  | 'task'        // ì‘ì—… ê´€ë¦¬
  | 'special';    // íŠ¹ìˆ˜ Tool

// Tool íŒŒë¼ë¯¸í„° ìŠ¤í‚¤ë§ˆ
export interface ToolSchema {
  type: 'object';
  properties: Record<string, any>;
  required: string[];
  additionalProperties: boolean;
}

// Tool ì‹¤í–‰ê¸° ì¸í„°í˜ì´ìŠ¤
export type ToolExecutor = (
  params: any,
  context: ToolExecutionContext
) => Promise<ToolResult> | AsyncGenerator<ToolResult>;

// Tool ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸
export interface ToolExecutionContext {
  sessionId: string;
  workingDirectory: string;
  fileStates: Record<string, FileState>;
  permissions: ToolPermissions;
  abortSignal?: AbortSignal;
  steeringQueue?: h2AQueue;     // ì‹¤ì‹œê°„ Steering í ì°¸ì¡°
}

// Tool ê¶Œí•œ ì œì–´
export interface ToolPermissions {
  allowFileWrite: boolean;
  allowFileRead: boolean;
  allowBashExecution: boolean;
  allowNetworkAccess: boolean;
  restrictedPaths: string[];
}

// Tool í˜¸ì¶œ ì •ë³´
export interface ToolCall {
  id: string;
  name: string;
  parameters: any;
  timestamp: number;
}

// Tool ì‹¤í–‰ ê²°ê³¼
export interface ToolResult {
  toolCallId: string;
  success: boolean;
  data?: any;
  error?: string;
  duration: number;
  subAgentResult?: AgentResult; // SubAgent ì‹¤í–‰ ê²°ê³¼
}

// h2A ë¹„ë™ê¸° í ì¸í„°í˜ì´ìŠ¤(ì‹¤ì‹œê°„ Steering í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜)
export interface h2AQueue {
  push(message: SteeringMessage): void;
  next(): Promise<{ value: SteeringMessage | null; done: boolean }>;
  abort(): void;
  isAborted: boolean;
}

// ì‹¤ì‹œê°„ Steering ë©”ì‹œì§€
export interface SteeringMessage {
  type: 'user_input' | 'abort' | 'adjust_strategy';
  content: string;
  timestamp: number;
  priority: number;
}
```

### ë‹¨ê³„ 2.4: ì„¤ì • ì‹œìŠ¤í…œ íƒ€ì… ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/types/config.ts`
**íŒŒì¼ ë‚´ìš©**:
```typescript
/**
 * ì„¤ì • ì‹œìŠ¤í…œ íƒ€ì… ì •ì˜
 * ê³„ì¸µì  ì„¤ì • ê´€ë¦¬ ë° MCP í†µí•© ì§€ì›
 */

// ì£¼ìš” ì„¤ì • ì¸í„°í˜ì´ìŠ¤
export interface OpenClaudeConfig {
  // í•µì‹¬ ì„¤ì •
  core: CoreConfig;
  // UI ì„¤ì •
  ui: UIConfig;
  // Agent ì„¤ì •
  agent: AgentConfig;
  // Tool ì„¤ì •
  tools: ToolsConfig;
  // MCP ì„¤ì •
  mcp: MCPConfig;
  // ë¡œê·¸ ì„¤ì •
  logging: LoggingConfig;
}

// í•µì‹¬ ì„¤ì •
export interface CoreConfig {
  apiKey?: string;
  apiBaseUrl?: string;
  model: string;
  fallbackModel?: string;
  maxRetries: number;
  timeout: number;
  workingDirectory: string;
}

// UI ì„¤ì •
export interface UIConfig {
  theme: 'light' | 'dark' | 'auto';
  showProgress: boolean;
  enableAnimations: boolean;
  compactMode: boolean;
}

// Tool ì„¤ì •
export interface ToolsConfig {
  enabled: string[];
  disabled: string[];
  permissions: ToolPermissions;
  concurrency: {
    maxConcurrent: number;        // gW5 ë©”ì»¤ë‹ˆì¦˜ ê¸°ë°˜
    enableLoadBalancing: boolean; // ë™ì  ë¡œë“œ ë°¸ëŸ°ì‹±
  };
}

// MCP ì„¤ì •(ì—­ë¶„ì„ ê¸°ë°˜ MCP ë©”ì»¤ë‹ˆì¦˜)
export interface MCPConfig {
  servers: Record<string, MCPServerConfig>;
  globalTimeout: number;
  retryAttempts: number;
}

export interface MCPServerConfig {
  command: string;
  args: string[];
  transport: 'stdio' | 'http' | 'websocket';
  timeout?: number;
  env?: Record<string, string>;
  workingDirectory?: string;
  oauth?: OAuth2Config;
}

export interface OAuth2Config {
  clientId: string;
  clientSecret: string;
  authUrl: string;
  tokenUrl: string;
  scopes: string[];
}

// ë¡œê·¸ ì„¤ì •
export interface LoggingConfig {
  level: 'debug' | 'info' | 'warn' | 'error';
  file?: string;
  maxFileSize: number;
  maxFiles: number;
}

// ì„¤ì • ê²€ì¦ ì—ëŸ¬
export class ConfigValidationError extends Error {
  constructor(
    message: string,
    public path: string,
    public value: any
  ) {
    super(message);
    this.name = 'ConfigValidationError';
  }
}
```

---

## ğŸ“ 3ì£¼ì°¨: CLI í”„ë ˆì„ì›Œí¬ì™€ UI ì‹œìŠ¤í…œ

### ë‹¨ê³„ 3.1: CLI ì§„ì… íŒŒì¼ ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/cli.ts`
**íŒŒì¼ ë‚´ìš©**:
```typescript
#!/usr/bin/env node

/**
 * Open Claude Code CLI ì§„ì…ì 
 * ì—­ë¶„ì„ ê¸°ë°˜ CLI ì•„í‚¤í…ì²˜ ì„¤ê³„
 */

import { Command } from 'commander';
import { render } from 'ink';
import React from 'react';
import { App } from './ui/app';
import { ConfigManager } from './core/config-manager';
import { Logger } from './utils/logger';

const program = new Command();

// CLI ë²„ì „ ë° ê¸°ë³¸ ì •ë³´
program
  .name('claude')
  .description('Open source AI programming assistant')
  .version('1.0.0-alpha.1');

// ì£¼ìš” ëª…ë ¹ ì •ì˜(ì—­ë¶„ì„ ê¸°ë°˜ CLI ëª…ë ¹ êµ¬ì¡°)
program
  .argument('[prompt]', 'Initial prompt to send to Claude')
  .option('-m, --model <model>', 'Model to use (claude-3-5-sonnet, gpt-4)', 'claude-3-5-sonnet')
  .option('--fallback-model <model>', 'Fallback model if primary fails')
  .option('-c, --continue <session>', 'Continue previous session')
  .option('-r, --resume <session>', 'Resume session from history')
  .option('-p, --print', 'Print mode - non-interactive output')
  .option('-d, --debug', 'Enable debug logging')
  .option('--allowed-tools <tools>', 'Comma-separated list of allowed tools')
  .option('--disallowed-tools <tools>', 'Comma-separated list of disallowed tools')
  .option('--plan-mode', 'Start in plan mode (analysis only)')
  .option('--disable-steering', 'Disable real-time steering mechanism')
  .action(async (prompt, options) => {
    try {
      // ì„¤ì • ê´€ë¦¬ì ì´ˆê¸°í™”
      const configManager = new ConfigManager();
      await configManager.initialize();

      // ë¡œê·¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
      const logger = new Logger(options.debug ? 'debug' : 'info');

      // Tool ê¶Œí•œ íŒŒì‹±
      const allowedTools = options.allowedTools?.split(',').map((s: string) => s.trim());
      const disallowedTools = options.disallowedTools?.split(',').map((s: string) => s.trim());

      // ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • êµ¬ì¶•
      const appConfig = {
        initialPrompt: prompt,
        model: options.model,
        fallbackModel: options.fallbackModel,
        sessionId: options.continue || options.resume,
        printMode: options.print,
        planMode: options.planMode,
        enableSteering: !options.disableSteering,
        allowedTools,
        disallowedTools,
        debug: options.debug,
      };

      if (options.print && prompt) {
        // ë¹„ëŒ€í™”í˜• ëª¨ë“œ - ê²°ê³¼ ì§ì ‘ ì¶œë ¥
        const { AgentCore } = await import('./core/agent-core');
        const agent = new AgentCore(appConfig, configManager, logger);
        const result = await agent.executePrompt(prompt);
        console.log(result);
        process.exit(0);
      } else {
        // ëŒ€í™”í˜• ëª¨ë“œ - React/Ink UI ì‹œì‘
        const { unmount } = render(
          React.createElement(App, {
            config: appConfig,
            configManager,
            logger
          })
        );

        // ìš°ì•„í•œ ì¢…ë£Œ ì²˜ë¦¬
        process.on('SIGINT', () => {
          unmount();
          process.exit(0);
        });

        process.on('SIGTERM', () => {
          unmount();
          process.exit(0);
        });
      }
    } catch (error) {
      console.error('Failed to start Claude Code:', error);
      process.exit(1);
    }
  });

// ì»¤ë§¨ë“œë¼ì¸ ì¸ì íŒŒì‹±
program.parse();
```

### ë‹¨ê³„ 3.2: ë©”ì¸ UI ì• í”Œë¦¬ì¼€ì´ì…˜ ì»´í¬ë„ŒíŠ¸ ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/ui/app.tsx`
**íŒŒì¼ ë‚´ìš©**:
```typescript
/**
 * ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ UI ì»´í¬ë„ŒíŠ¸
 * ì—­ë¶„ì„ ê¸°ë°˜ React/Ink ì•„í‚¤í…ì²˜ ì„¤ê³„
 */

import React, { useState, useEffect } from 'react';
import { Box, Text, useInput } from 'ink';
import { ChatComponent } from './components/chat';
import { StatusComponent } from './components/status';
import { ProgressComponent } from './components/progress';
import { useAgent } from './hooks/use-agent';
import { useChat } from './hooks/use-chat';
import type { ConfigManager } from '../core/config-manager';
import type { Logger } from '../utils/logger';

interface AppProps {
  config: any;
  configManager: ConfigManager;
  logger: Logger;
}

export const App: React.FC<AppProps> = ({ config, configManager, logger }) => {
  // Agent ìƒíƒœ ê´€ë¦¬
  const {
    agent,
    status,
    error,
    initialize,
    executePrompt,
    abort
  } = useAgent(config, configManager, logger);

  // ëŒ€í™” ìƒíƒœ ê´€ë¦¬
  const {
    messages,
    addMessage,
    clearMessages
  } = useChat();

  // UI ìƒíƒœ
  const [currentMode, setCurrentMode] = useState<'default' | 'plan' | 'bash' | 'note'>('default');
  const [inputBuffer, setInputBuffer] = useState('');
  const [isMultilineInput, setIsMultilineInput] = useState(false);

  // Agent ì´ˆê¸°í™”
  useEffect(() => {
    initialize();

    // ì´ˆê¸° í”„ë¡¬í”„íŠ¸ ì²˜ë¦¬
    if (config.initialPrompt) {
      addMessage({
        id: Date.now().toString(),
        role: 'user',
        content: config.initialPrompt,
        timestamp: Date.now()
      });
      executePrompt(config.initialPrompt);
    }
  }, []);

  // í‚¤ë³´ë“œ ì…ë ¥ ì²˜ë¦¬(ì—­ë¶„ì„ ê¸°ë°˜ ìƒí˜¸ì‘ìš© ëª¨ë“œ)
  useInput((input, key) => {
    // Shift+Tab ëª¨ë“œ ì „í™˜(ì—­ë¶„ì„ ê¸°ë°˜ Plan ëª¨ë“œ ë©”ì»¤ë‹ˆì¦˜)
    if (key.shift && key.tab) {
      const modes = ['default', 'plan', 'bash', 'note'] as const;
      const currentIndex = modes.indexOf(currentMode);
      const nextMode = modes[(currentIndex + 1) % modes.length];
      setCurrentMode(nextMode);
      return;
    }

    // Ctrl+C ì‹¤í–‰ ì¤‘ë‹¨
    if (key.ctrl && input === 'c') {
      abort();
      return;
    }

    // Ctrl+L ëŒ€í™” ì§€ìš°ê¸°
    if (key.ctrl && input === 'l') {
      clearMessages();
      return;
    }

    // Enter ë©”ì‹œì§€ ì „ì†¡
    if (key.return) {
      if (inputBuffer.trim()) {
        handleUserInput(inputBuffer.trim());
        setInputBuffer('');
      }
      return;
    }

    // ì¼ë°˜ ë¬¸ì ì…ë ¥
    if (!key.ctrl && !key.meta) {
      setInputBuffer(prev => prev + input);
    }

    // Backspace ë¬¸ì ì‚­ì œ
    if (key.backspace || key.delete) {
      setInputBuffer(prev => prev.slice(0, -1));
    }
  });

  // ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬(ì—­ë¶„ì„ ê¸°ë°˜ ìƒí˜¸ì‘ìš© ëª¨ë“œ ë©”ì»¤ë‹ˆì¦˜)
  const handleUserInput = async (input: string) => {
    // íŠ¹ìˆ˜ ëª¨ë“œ ì ‘ë‘ì‚¬ í™•ì¸
    if (input.startsWith('!')) {
      // Bash ì‹¤í–‰ ëª¨ë“œ
      const command = input.slice(1).trim();
      await handleBashCommand(command);
      return;
    }

    if (input.startsWith('#')) {
      // ë©”ëª¨ ê¸°ë¡ ëª¨ë“œ
      const note = input.slice(1).trim();
      await handleNoteCommand(note);
      return;
    }

    if (input.startsWith('/')) {
      // ìŠ¬ë˜ì‹œ ëª…ë ¹ ì²˜ë¦¬
      await handleSlashCommand(input);
      return;
    }

    // ì¼ë°˜ ëŒ€í™” ë©”ì‹œì§€
    const message = {
      id: Date.now().toString(),
      role: 'user' as const,
      content: input,
      timestamp: Date.now()
    };

    addMessage(message);
    await executePrompt(input);
  };

  // Bash ëª…ë ¹ ì²˜ë¦¬
  const handleBashCommand = async (command: string) => {
    addMessage({
      id: Date.now().toString(),
      role: 'user',
      content: `!${command}`,
      timestamp: Date.now()
    });

    // Bash Tool ì§ì ‘ í˜¸ì¶œ
    await executePrompt(`ëª…ë ¹ ì‹¤í–‰: ${command}`, {
      forceToolUse: 'bash',
      toolParams: { command }
    });
  };

  // ë©”ëª¨ ëª…ë ¹ ì²˜ë¦¬
  const handleNoteCommand = async (note: string) => {
    addMessage({
      id: Date.now().toString(),
      role: 'user',
      content: `#${note}`,
      timestamp: Date.now()
    });

    // ë©”ëª¨ ì‹œìŠ¤í…œì— ê¸°ë¡
    await executePrompt(`ë©”ëª¨ ê¸°ë¡: ${note}`, {
      forceToolUse: 'todo_write',
      isNote: true
    });
  };

  // ìŠ¬ë˜ì‹œ ëª…ë ¹ ì²˜ë¦¬
  const handleSlashCommand = async (command: string) => {
    const [cmd, ...args] = command.slice(1).split(' ');

    switch (cmd) {
      case 'help':
        showHelpMessage();
        break;
      case 'clear':
        clearMessages();
        break;
      case 'login':
        await handleLoginCommand();
        break;
      case 'logout':
        await handleLogoutCommand();
        break;
      case 'mcp':
        await handleMCPCommand(args);
        break;
      case 'status':
        showStatusMessage();
        break;
      default:
        addMessage({
          id: Date.now().toString(),
          role: 'system',
          content: `ì•Œ ìˆ˜ ì—†ëŠ” ëª…ë ¹: ${cmd}. /helpë¥¼ ì…ë ¥í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì„ í™•ì¸í•˜ì„¸ìš”.`,
          timestamp: Date.now()
        });
    }
  };

  // ë„ì›€ë§ ì •ë³´ í‘œì‹œ
  const showHelpMessage = () => {
    addMessage({
      id: Date.now().toString(),
      role: 'system',
      content: `ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹:
/help - ë„ì›€ë§ í‘œì‹œ
/clear - ëŒ€í™” ê¸°ë¡ ì§€ìš°ê¸°
/login - ì‚¬ìš©ì ë¡œê·¸ì¸
/logout - ì‚¬ìš©ì ë¡œê·¸ì•„ì›ƒ
/mcp - MCP ì„œë²„ ê´€ë¦¬
/status - ì‹œìŠ¤í…œ ìƒíƒœ í‘œì‹œ

íŠ¹ìˆ˜ ëª¨ë“œ:
! <ëª…ë ¹> - Bash ëª…ë ¹ ì§ì ‘ ì‹¤í–‰
# <ë©”ëª¨> - ë©”ëª¨ ê¸°ë¡
Shift+Tab - ëª¨ë“œ ì „í™˜ (default/plan/bash/note)
Ctrl+C - ì‹¤í–‰ ì¤‘ë‹¨
Ctrl+L - ëŒ€í™” ì§€ìš°ê¸°`,
      timestamp: Date.now()
    });
  };

  // ìƒíƒœ ì •ë³´ í‘œì‹œ
  const showStatusMessage = () => {
    addMessage({
      id: Date.now().toString(),
      role: 'system',
      content: `ì‹œìŠ¤í…œ ìƒíƒœ:
Agent ìƒíƒœ: ${status}
í˜„ì¬ ëª¨ë“œ: ${currentMode}
ì‹¤ì‹œê°„ Steering: ${config.enableSteering ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}
Plan ëª¨ë“œ: ${config.planMode ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}
í˜„ì¬ ëª¨ë¸: ${config.model}`,
      timestamp: Date.now()
    });
  };

  // ë¡œê·¸ì¸ ì²˜ë¦¬
  const handleLoginCommand = async () => {
    // TODO: OAuth ë¡œê·¸ì¸ í”Œë¡œìš° êµ¬í˜„
    addMessage({
      id: Date.now().toString(),
      role: 'system',
      content: 'ë¡œê·¸ì¸ ê¸°ëŠ¥ì€ í–¥í›„ ë²„ì „ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤',
      timestamp: Date.now()
    });
  };

  // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
  const handleLogoutCommand = async () => {
    // TODO: ë¡œê·¸ì•„ì›ƒ ë¡œì§ êµ¬í˜„
    addMessage({
      id: Date.now().toString(),
      role: 'system',
      content: 'ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ì€ í–¥í›„ ë²„ì „ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤',
      timestamp: Date.now()
    });
  };

  // MCP ëª…ë ¹ ì²˜ë¦¬
  const handleMCPCommand = async (args: string[]) => {
    // TODO: MCP ê´€ë¦¬ ë¡œì§ êµ¬í˜„
    addMessage({
      id: Date.now().toString(),
      role: 'system',
      content: 'MCP ê´€ë¦¬ ê¸°ëŠ¥ì€ í–¥í›„ ë²„ì „ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤',
      timestamp: Date.now()
    });
  };

  return (
    <Box flexDirection="column" height="100%">
      {/* ì œëª© í‘œì‹œì¤„ */}
      <Box borderStyle="single" paddingX={1}>
        <Text bold color="blue">
          Open Claude Code v1.0.0-alpha.1
        </Text>
        <Text> - ëª¨ë“œ: {currentMode}</Text>
        {config.planMode && (
          <Text color="yellow"> [PLAN MODE - ë¶„ì„ë§Œ ìˆ˜í–‰, ì‹¤í–‰ ì•ˆ í•¨]</Text>
        )}
      </Box>

      {/* ìƒíƒœ í‘œì‹œì¤„ */}
      <StatusComponent
        status={status}
        model={config.model}
        enableSteering={config.enableSteering}
      />

      {/* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */}
      <Box flex={1} flexDirection="column">
        {/* ëŒ€í™” ì˜ì—­ */}
        <Box flex={1}>
          <ChatComponent
            messages={messages}
            status={status}
          />
        </Box>

        {/* ì§„í–‰ ìƒí™© ì˜ì—­ */}
        {status === 'tool_calling' || status === 'streaming' ? (
          <ProgressComponent
            status={status}
          />
        ) : null}
      </Box>

      {/* ì…ë ¥ ì˜ì—­ */}
      <Box borderStyle="single" paddingX={1}>
        <Text>
          [{currentMode}] > {inputBuffer}
          <Text backgroundColor="white" color="black">â–ˆ</Text>
        </Text>
      </Box>

      {/* ì—ëŸ¬ í‘œì‹œ */}
      {error && (
        <Box borderStyle="single" borderColor="red" paddingX={1}>
          <Text color="red">ì—ëŸ¬: {error.message}</Text>
        </Box>
      )}

      {/* ë„ì›€ë§ íŒíŠ¸ */}
      <Box paddingX={1}>
        <Text dimColor>
          Shift+Tab: ëª¨ë“œ ì „í™˜ | Ctrl+C: ì¤‘ë‹¨ | Ctrl+L: ì§€ìš°ê¸° | /help: ë„ì›€ë§
        </Text>
      </Box>
    </Box>
  );
};
```

---

## ğŸ“ 4ì£¼ì°¨: ê¸°ë³¸ ì„¤ì • ë° ë¹Œë“œ ì‹œìŠ¤í…œ

### ë‹¨ê³„ 4.1: ì„¤ì • ê´€ë¦¬ì ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `src/core/config-manager.ts`
**íŒŒì¼ ë‚´ìš©**:
```typescript
/**
 * ì„¤ì • ê´€ë¦¬ì
 * ê³„ì¸µì  ì„¤ì • ê´€ë¦¬ ë° ëŸ°íƒ€ì„ ì—…ë°ì´íŠ¸ ì§€ì›
 */

import fs from 'fs/promises';
import path from 'path';
import { z } from 'zod';
import type { OpenClaudeConfig } from '../types/config';

// ì„¤ì • ê²€ì¦ ìŠ¤í‚¤ë§ˆ
const ConfigSchema = z.object({
  core: z.object({
    apiKey: z.string().optional(),
    apiBaseUrl: z.string().optional(),
    model: z.string().default('claude-3-5-sonnet'),
    fallbackModel: z.string().optional(),
    maxRetries: z.number().default(3),
    timeout: z.number().default(30000),
    workingDirectory: z.string().default(process.cwd()),
  }),
  ui: z.object({
    theme: z.enum(['light', 'dark', 'auto']).default('auto'),
    showProgress: z.boolean().default(true),
    enableAnimations: z.boolean().default(true),
    compactMode: z.boolean().default(false),
  }),
  agent: z.object({
    model: z.string().default('claude-3-5-sonnet'),
    fallbackModel: z.string().optional(),
    maxTokens: z.number().optional(),
    temperature: z.number().default(0.7),
    enableSteering: z.boolean().default(true),
    concurrencyLimit: z.number().default(10),
    allowedTools: z.array(z.string()).optional(),
    disallowedTools: z.array(z.string()).optional(),
    planMode: z.boolean().default(false),
  }),
  tools: z.object({
    enabled: z.array(z.string()).default([]),
    disabled: z.array(z.string()).default([]),
    permissions: z.object({
      allowFileWrite: z.boolean().default(true),
      allowFileRead: z.boolean().default(true),
      allowBashExecution: z.boolean().default(true),
      allowNetworkAccess: z.boolean().default(true),
      restrictedPaths: z.array(z.string()).default([]),
    }),
    concurrency: z.object({
      maxConcurrent: z.number().default(10),
      enableLoadBalancing: z.boolean().default(true),
    }),
  }),
  mcp: z.object({
    servers: z.record(z.object({
      command: z.string(),
      args: z.array(z.string()).default([]),
      transport: z.enum(['stdio', 'http', 'websocket']).default('stdio'),
      timeout: z.number().optional(),
      env: z.record(z.string()).optional(),
      workingDirectory: z.string().optional(),
      oauth: z.object({
        clientId: z.string(),
        clientSecret: z.string(),
        authUrl: z.string(),
        tokenUrl: z.string(),
        scopes: z.array(z.string()).default([]),
      }).optional(),
    })).default({}),
    globalTimeout: z.number().default(30000),
    retryAttempts: z.number().default(3),
  }),
  logging: z.object({
    level: z.enum(['debug', 'info', 'warn', 'error']).default('info'),
    file: z.string().optional(),
    maxFileSize: z.number().default(10 * 1024 * 1024), // 10MB
    maxFiles: z.number().default(5),
  }),
});

export class ConfigManager {
  private config: OpenClaudeConfig;
  private configPaths: string[];

  constructor() {
    // ì„¤ì • íŒŒì¼ ê²€ìƒ‰ ê²½ë¡œ(ê³„ì¸µì  ì„¤ì • ì§€ì›)
    this.configPaths = [
      path.join(process.cwd(), '.claude.json'),     // í”„ë¡œì íŠ¸ ìˆ˜ì¤€ ì„¤ì •
      path.join(process.cwd(), '.claude.config.js'), // í”„ë¡œì íŠ¸ ìˆ˜ì¤€ JS ì„¤ì •
      path.join(os.homedir(), '.claude', 'config.json'), // ì‚¬ìš©ì ìˆ˜ì¤€ ì„¤ì •
      '/etc/claude/config.json',                    // ì‹œìŠ¤í…œ ìˆ˜ì¤€ ì„¤ì •
    ];

    // ê¸°ë³¸ ì„¤ì •
    this.config = ConfigSchema.parse({});
  }

  async initialize(): Promise<void> {
    // ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì„¤ì • íŒŒì¼ ë¡œë“œ
    for (const configPath of this.configPaths) {
      try {
        await this.loadConfigFile(configPath);
      } catch (error) {
        // ì„¤ì • íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ í˜•ì‹ ì˜¤ë¥˜, ë‹¤ìŒ ì‹œë„
        continue;
      }
    }

    // í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ë¡œë“œ
    this.loadEnvironmentConfig();

    // ìµœì¢… ì„¤ì • ê²€ì¦
    this.validateConfig();
  }

  private async loadConfigFile(configPath: string): Promise<void> {
    try {
      const content = await fs.readFile(configPath, 'utf-8');
      let configData: any;

      if (configPath.endsWith('.js')) {
        // JS ì„¤ì • íŒŒì¼ ë™ì  ì„í¬íŠ¸
        const module = await import(configPath);
        configData = module.default || module;
      } else {
        // JSON ì„¤ì • íŒŒì¼ íŒŒì‹±
        configData = JSON.parse(content);
      }

      // ì„¤ì • ê¹Šì€ ë³‘í•©
      this.config = this.deepMerge(this.config, configData);
    } catch (error) {
      throw new Error(`Failed to load config from ${configPath}: ${error}`);
    }
  }

  private loadEnvironmentConfig(): void {
    // í™˜ê²½ ë³€ìˆ˜ì—ì„œ ì„¤ì • ë¡œë“œ
    const envConfig: any = {};

    // API ì„¤ì •
    if (process.env.ANTHROPIC_API_KEY) {
      envConfig.core = {
        ...envConfig.core,
        apiKey: process.env.ANTHROPIC_API_KEY
      };
    }

    if (process.env.CLAUDE_MODEL) {
      envConfig.agent = {
        ...envConfig.agent,
        model: process.env.CLAUDE_MODEL
      };
    }

    if (process.env.CLAUDE_DEBUG) {
      envConfig.logging = {
        ...envConfig.logging,
        level: 'debug'
      };
    }

    // í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ë³‘í•©
    if (Object.keys(envConfig).length > 0) {
      this.config = this.deepMerge(this.config, envConfig);
    }
  }

  private validateConfig(): void {
    try {
      this.config = ConfigSchema.parse(this.config);
    } catch (error) {
      throw new Error(`Configuration validation failed: ${error}`);
    }
  }

  private deepMerge(target: any, source: any): any {
    const result = { ...target };

    for (const key in source) {
      if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
        result[key] = this.deepMerge(result[key] || {}, source[key]);
      } else {
        result[key] = source[key];
      }
    }

    return result;
  }

  // ì„¤ì • ê°€ì ¸ì˜¤ê¸°
  getConfig(): OpenClaudeConfig {
    return { ...this.config };
  }

  // íŠ¹ì • ì„¤ì • ì„¹ì…˜ ê°€ì ¸ì˜¤ê¸°
  getSection<K extends keyof OpenClaudeConfig>(section: K): OpenClaudeConfig[K] {
    return { ...this.config[section] };
  }

  // ì„¤ì • ì—…ë°ì´íŠ¸
  updateConfig(updates: Partial<OpenClaudeConfig>): void {
    this.config = this.deepMerge(this.config, updates);
    this.validateConfig();
  }

  // ì„¤ì •ì„ íŒŒì¼ë¡œ ì €ì¥
  async saveConfig(configPath?: string): Promise<void> {
    const targetPath = configPath || this.configPaths[0];
    const configJson = JSON.stringify(this.config, null, 2);

    // ë””ë ‰í† ë¦¬ ì¡´ì¬ í™•ì¸
    await fs.mkdir(path.dirname(targetPath), { recursive: true });

    // ì„¤ì • íŒŒì¼ ì“°ê¸°
    await fs.writeFile(targetPath, configJson, 'utf-8');
  }
}
```

### ë‹¨ê³„ 4.2: í…ŒìŠ¤íŠ¸ ì„¤ì • ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `jest.config.js`
**íŒŒì¼ ë‚´ìš©**:
```javascript
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  roots: ['<rootDir>/src', '<rootDir>/tests'],
  testMatch: [
    '**/__tests__/**/*.ts',
    '**/?(*.)+(spec|test).ts'
  ],
  transform: {
    '^.+\\.ts$': 'ts-jest',
  },
  collectCoverageFrom: [
    'src/**/*.ts',
    '!src/**/*.d.ts',
    '!src/cli.ts',
  ],
  coverageDirectory: 'coverage',
  coverageReporters: ['text', 'lcov', 'html'],
  moduleNameMapping: {
    '^@/(.*)$': '<rootDir>/src/$1',
  },
  setupFilesAfterEnv: ['<rootDir>/tests/setup.ts'],
};
```

### ë‹¨ê³„ 4.3: Git ë¬´ì‹œ íŒŒì¼ ìƒì„±
**íŒŒì¼ ê²½ë¡œ**: `.gitignore`
**íŒŒì¼ ë‚´ìš©**:
```
# ì˜ì¡´ì„± ë””ë ‰í† ë¦¬
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# ë¹Œë“œ ì¶œë ¥
dist/
build/
*.tsbuildinfo

# í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€
coverage/
.nyc_output/

# ëŸ°íƒ€ì„ íŒŒì¼
*.log
*.pid
*.seed
*.pid.lock

# í™˜ê²½ ë³€ìˆ˜
.env
.env.local
.env.*.local

# IDE ì„¤ì •
.vscode/
.idea/
*.swp
*.swo

# ìš´ì˜ ì²´ì œ íŒŒì¼
.DS_Store
Thumbs.db

# ì„¤ì • íŒŒì¼
.claude.json
.claude.config.js

# ì„ì‹œ íŒŒì¼
*.tmp
*.temp
.cache/
```

---

## âœ… 1ë‹¨ê³„ ê²€ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í™˜ê²½ ê²€ì¦
- [ ] Node.js ë²„ì „ >= 18.0.0
- [ ] TypeScript ì»´íŒŒì¼ ì„±ê³µ
- [ ] ëª¨ë“  ì˜ì¡´ì„± ì„¤ì¹˜ ì™„ë£Œ
- [ ] ESLint ê²€ì‚¬ í†µê³¼
- [ ] Jest í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ì •ìƒ ì‘ë™

### íŒŒì¼ êµ¬ì¡° ê²€ì¦
- [ ] ëª¨ë“  ë””ë ‰í† ë¦¬ ê·œê²©ëŒ€ë¡œ ìƒì„±
- [ ] íƒ€ì… ì •ì˜ íŒŒì¼ ì™„ì „
- [ ] CLI ì§„ì… íŒŒì¼ ì‹¤í–‰ ê°€ëŠ¥
- [ ] ì„¤ì • ê´€ë¦¬ì ì •ìƒ ì‘ë™
- [ ] UI í”„ë ˆì„ì›Œí¬ ê¸°ë³¸ êµ¬ì¶• ì™„ë£Œ

### ê¸°ëŠ¥ ê²€ì¦
- [ ] `npm run build` ì»´íŒŒì¼ ì„±ê³µ
- [ ] `npm run dev` ê°œë°œ ëª¨ë“œ ì‹œì‘
- [ ] `npm run test` í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- [ ] `npm run lint` ì½”ë“œ ê²€ì‚¬ í†µê³¼
- [ ] CLI ëª…ë ¹ `claude --help` ì •ìƒ í‘œì‹œ

### ì½”ë“œ í’ˆì§ˆ ê²€ì¦
- [ ] TypeScript íƒ€ì… ì •ì˜ ì™„ì „
- [ ] ì½”ë“œê°€ ESLint ê·œë²” ì¤€ìˆ˜
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ > 60%
- [ ] ëª¨ë“  íŒŒì¼ì— ì ì ˆí•œ ì£¼ì„ í¬í•¨
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ ì™„ë¹„

---

## ğŸš€ 1ë‹¨ê³„ ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„

1ë‹¨ê³„ ì™„ë£Œ í›„, ì™„ì „í•œ í”„ë¡œì íŠ¸ ê¸°ì´ˆ ì•„í‚¤í…ì²˜ë¥¼ ê°–ì¶”ê²Œ ë©ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•  ì‚¬í•­:

1. **ê²€ìˆ˜ í…ŒìŠ¤íŠ¸**: ëª¨ë“  ì²´í¬ í•­ëª© í†µê³¼ í™•ì¸
2. **ë¬¸ì„œ ì—…ë°ì´íŠ¸**: README.md ë° API ë¬¸ì„œ ë³´ì™„
3. **ì½”ë“œ ë¦¬ë·°**: ì½”ë“œ í’ˆì§ˆê³¼ ê·œë²”ì„± í™•ì¸
4. **2ë‹¨ê³„ ì§„ì…**: Tool ì‹œìŠ¤í…œê³¼ Agent í•µì‹¬ ê°œë°œ ì‹œì‘

**ì˜ˆìƒ ê²°ê³¼**: ì‹œì‘ ê°€ëŠ¥í•˜ê³ , ê¸°ë³¸ CLI ë° UI í”„ë ˆì„ì›Œí¬ë¥¼ ê°–ì¶˜ í”„ë¡œì íŠ¸ ê³¨ê²©ìœ¼ë¡œ, í–¥í›„ ê°œë°œì„ ìœ„í•œ ê²¬ê³ í•œ ê¸°ë°˜ ë§ˆë ¨.

---

*Claude Code ì—­ë¶„ì„ ê¸°ë°˜ì˜ ì •í™•í•œ ê¸°ìˆ  ê°€ì´ë“œë¡œ, ëª¨ë“  êµ¬í˜„ ì„¸ë¶€ ì‚¬í•­ì´ ì›ë³¸ ì•„í‚¤í…ì²˜ ì„¤ê³„ì™€ ì¼ì¹˜í•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.*
