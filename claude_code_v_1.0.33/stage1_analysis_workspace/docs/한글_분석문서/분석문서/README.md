# Claude Code 역공학 분석 문서 - 한국어판

## 개요

본 디렉토리는 Claude Code v1.0.33의 중국어 원본 분석 문서를 읽기 쉬운 한국어로 완전히 재작성한 문서들을 포함합니다.

## 재작성 원칙

1. **의역 중심**: 직역이 아닌 자연스러운 한국어로 작성
2. **다이어그램 최적화**: ASCII 아트를 깔끔하게 재구성
3. **기술 용어 유지**: 영어 기술 용어는 원문 유지
4. **주석 번역**: 코드 블록 내 주석도 한국어로 번역
5. **개념 명확화**: 복잡한 개념은 쉽게 풀어서 설명

## 문서 목록

### 핵심 검증 보고서

- **01_소스코드_검증_보고서.md**: 기술적 주장에 대한 실제 소스코드 검증 결과
- **02_메모리_컨텍스트_관리_시스템.md**: AU2 함수 및 메모리 관리 시스템 완전 분석
- **03_스트리밍_UI_렌더링_분석.md**: React 기반 터미널 UI 및 스트리밍 메커니즘
- **04_Todo_도구_완전_분석.md**: TodoRead/TodoWrite 도구의 완전한 역공학 분석

### 아키텍처 분석

5. **시스템_아키텍처_종합.md**: 5계층 시스템 아키텍처 및 설계 원칙
6. **Agent_Loop_심층_분석.md**: 주 Agent 루프의 상태 머신 및 실행 흐름
7. **도구_편성_메커니즘.md**: 15개 도구의 동시성 제어 및 권한 관리

### UI 및 상호작용

8. **프론트엔드_UI_상호작용_분석.md**: React/Ink 기반 터미널 UI 컴포넌트
9. **사용자_인터페이스_검증.md**: UI 컴포넌트 혼동 코드 추적 및 복원
10. **System_Reminder_메커니즘.md**: 동적 컨텍스트 주입 및 알림 시스템

### 특수 기능

11. **Task_Agent_아키텍처.md**: SubAgent 시작 및 격리 메커니즘
12. **특수_기능_구현_분석.md**: System-reminder, 도구 호출, 환경 정보 주입
13. **Bash_Git_워크플로우.md**: Git 통합 및 자동화 메커니즘

### 검증 및 감사

14. **메모리_시스템_검증.md**: 메모리 관리 시스템의 소스코드 검증 (100% 정확도)
15. **Agent_Loop_검증.md**: Agent 루프 구현의 정확성 검증
16. **도구_시스템_검증.md**: 도구 아키텍처 및 실행 메커니즘 검증
17. **환각_감사_보고서.md**: 모든 분석 문서의 환각 및 추측 내용 감사

## 주요 발견사항

### ✅ 완전히 검증된 내용

1. **MH1 도구 실행 엔진**: 6단계 실행 파이프라인 (100% 검증)
2. **동시성 제어**: gW5 = 10 (동시 도구 실행 제한)
3. **AU2 템플릿 생성기**: 8단계 대화 요약 프롬프트 생성 (이전의 "압축 알고리즘" 오해 수정)
4. **92% 압축 임계값**: h11 = 0.92 (자동 압축 트리거)
5. **Todo 도구 아키텍처**: Agent별 격리 및 JSON 저장

### ❌ 삭제된 환각 내용

1. **25회 대화 순환 제한**: 소스코드 증거 없음
2. **AU2 = 8단계 압축 알고리즘**: 실제로는 템플릿 생성기
3. **특정 행 번호 주장**: 검증 불가능한 과도한 구체화

### ⚠️ 추측으로 표시된 내용

1. 일부 알고리즘 구현 세부사항
2. 아키텍처 구성 요소 간 연결 관계
3. 성능 최적화 전략의 일부

## 기술 정확도 평가

| 문서 카테고리 | 정확도 | 비고 |
|------------|--------|------|
| 소스코드 검증 | 98% | 직접 소스코드 기반 |
| 메모리 시스템 | 100% | AU2 오해 수정 완료 |
| Todo 도구 | 95% | 완전한 코드 복원 |
| Agent Loop | 88% | 일부 추론 포함 |
| UI 컴포넌트 | 95% | React/Ink 확인 |
| Task Agent | 93% | 격리 메커니즘 검증 |

## 핵심 아키텍처 다이어그램

### 전체 시스템 구조

```
┌─────────────────────────────────────────────────────────────┐
│                    Claude Code 시스템                        │
├─────────────────────────────────────────────────────────────┤
│  1. UI 레이어 (React/Ink)                                   │
│     - 터미널 컴포넌트                                       │
│     - 실시간 상태 표시                                      │
├─────────────────────────────────────────────────────────────┤
│  2. Agent 레이어                                            │
│     - Main Agent Loop (nO)                                  │
│     - SubAgent 관리                                         │
│     - 상태 머신                                             │
├─────────────────────────────────────────────────────────────┤
│  3. 도구 레이어                                             │
│     - 도구 실행 엔진 (MH1)                                  │
│     - 동시성 제어                                           │
│     - 권한 관리                                             │
├─────────────────────────────────────────────────────────────┤
│  4. 메모리 레이어                                           │
│     - Token 계산 (VE, zY5)                                  │
│     - 압축 메커니즘 (AU2, qH1)                              │
│     - system-reminder 주입 (Ie1)                            │
├─────────────────────────────────────────────────────────────┤
│  5. 저장 레이어                                             │
│     - 메시지 배열                                           │
│     - CLAUDE.md 파일                                        │
│     - Todo 데이터 (JSON)                                    │
└─────────────────────────────────────────────────────────────┘
```

### 도구 실행 흐름

```
사용자 요청
    ↓
Agent Loop (nO)
    ↓
도구 선택 & 권한 확인
    ↓
도구 실행 엔진 (MH1)
    ↓
┌─────────────────────────────────────┐
│ 동시성 안전 도구 │ 비안전 도구       │
│ (병렬 실행)      │ (순차 실행)       │
├─────────────────────────────────────┤
│ - Bash           │ - Edit            │
│ - Read           │ - Write           │
│ - Grep           │ - TodoWrite       │
│ - WebFetch       │ - MultiEdit       │
└─────────────────────────────────────┘
    ↓
결과 수집 & 포맷팅
    ↓
UI 업데이트 & 사용자 표시
```

## 함수 난독화 해제 매핑

| 난독화명 | 실제 기능 | 파일 위치 |
|---------|----------|----------|
| MH1 | 도구 실행 엔진 | chunks.95.mjs |
| AU2 | 압축 프롬프트 템플릿 생성기 | chunks.94.mjs |
| VE | 최신 Token 사용량 계산 | chunks.94.mjs |
| zY5 | Token 종합 계산 (캐시 포함) | chunks.94.mjs |
| Ie1 | system-reminder 동적 주입 | chunks.94.mjs |
| yG | TodoWrite 도구 | improved-claude-code-5.mjs |
| oN | TodoRead 도구 | improved-claude-code-5.mjs |
| nO | Main Agent Loop | 다수 파일 |
| wu | 언어 모델 호출 | 다수 파일 |

## 성능 및 제한사항

### 리소스 제한

- **동시 도구 실행**: 최대 10개 (gW5 = 10)
- **압축 트리거**: 컨텍스트 사용률 92% (h11 = 0.92)
- **압축 출력 제한**: 16384 Token (CU2)
- **파일 복원**: 최대 20개 파일, 각각 8192 Token

### 성능 최적화

1. **역방향 탐색**: Token 계산 시 메시지 배열 끝에서 시작
2. **캐시 인식**: prompt caching을 고려한 Token 계산
3. **병렬 실행**: 안전한 도구들의 동시 실행
4. **스트리밍**: 비동기 생성기를 통한 실시간 응답

## 보안 메커니즘

### 6계층 보안 체계

1. **입력 검증**: Zod Schema를 통한 엄격한 검증
2. **권한 확인**: 도구별 checkPermissions 메서드
3. **파일 시스템 격리**: 허용된 경로만 접근
4. **악성 코드 감지**: 파일 읽기 시 보안 알림
5. **네트워크 제한**: 허용된 도메인만 접근
6. **리소스 제한**: 메모리 및 실행 시간 제한

## 사용 권장사항

### 문서 탐색 순서

1. **초보자**: 01 → 02 → 03 → 04 순서로 읽기
2. **개발자**: 05 → 06 → 07 → 11 → 12 순서로 읽기
3. **연구자**: 14 → 15 → 16 → 17 검증 문서 먼저 읽기

### 신뢰도 가이드

- **✅ [소스코드 검증]**: 직접 소스코드에서 확인된 내용
- **⚠️ [패턴 추론]**: 코드 패턴을 기반으로 한 합리적 추론
- **🔍 [동작 추론]**: 시스템 동작을 기반으로 한 논리적 추론
- **❓ [기술 추측]**: 충분한 증거가 부족한 내용

## 기여 및 업데이트

본 문서는 Claude Code v1.0.33의 분석 결과입니다. 새로운 버전이나 추가 발견사항이 있으면 지속적으로 업데이트됩니다.

### 검증 날짜

- 소스코드 검증: 2025-06-26
- 메모리 시스템 검증: 2025-06-26
- 환각 감사: 2025-06-26

---

**면책 조항**: 본 문서는 교육 및 연구 목적으로 작성되었습니다. Claude Code는 Anthropic의 공식 CLI 도구이며, 본 분석은 비공식 역공학 결과입니다. 실제 구현은 버전에 따라 다를 수 있습니다.

---

**문서 버전**: 1.0
**원본 언어**: 중국어
**번역 및 재작성**: 한국어
**최종 업데이트**: 2025-12-24
